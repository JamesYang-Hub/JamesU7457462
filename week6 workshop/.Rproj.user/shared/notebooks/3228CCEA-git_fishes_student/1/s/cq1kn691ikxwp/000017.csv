"0","# "
"0","# data_species <- c('acantho','ambon','chromis','humbug','lemon','whitedams')"
"0","# pval <- c()"
"0","# dfval <- c()"
"0","# mean_difference <- c()"
"0","# for (i in 1:6) {"
"0","#   fit_control <- drop_data %>%"
"0","#     select(species,treatment,activity) %>%"
"0","#     filter(species==data_species[i]& treatment== 'control')"
"0","# "
"0","#   fit_CO2 <- drop_data %>%"
"0","#     select(species,treatment,activity) %>%"
"0","#     filter(species==data_species[i]& treatment== 'CO2')"
"0","# "
"0","#   # fit_control_temp <- mean()"
"0","#  mean_difference[i] <-  abs( ( drop_data %>% filter(species==data_species[i]& treatment=='control') %>% summarise(mean = mean(activity)))-   (     drop_data %>% filter(species==data_species[i]& treatment== 'CO2' ) %>% summarise(mean = mean(activity))"
"0","#                              "
"0","#                              "
"0","#  pval[i] <- t.test(fit_control[3],fit_CO2[3])$p.value"
"0","#  dfval[i]<- t.test(fit_control[3],fit_CO2[3])$df"
"0","# "
"0","# }"
"0","# "
"0","# for (i in 1:6) { print(i)}"
"0","# "
"0","# pval"
"0","# dfval"
"0","# mean_difference"
"0","#如果没有安装dplyr，rstatix和reshape2这三个R包，先去掉下面三行的#，运行进行安装"
"0","# install.packages(""BiocManager"")"
"0","# BiocManager::install(""dplyr"")"
"0","# BiocManager::install(""rstatix"")"
"0","# BiocManager::install(""reshape2"")"
"0","# "
"0","# library(dplyr)"
"0","# library(rstatix)"
"0","# library(reshape2)"
"0","# result=melt(fit1) %>%"
"0","#   group_by(species) %>%"
"0","#   t_test(species ~ treatment)"
"0","# result"
"0","# Provide the difference in means, their 95% confidence intervals, t-statistic, df and p-value."
"0","fit1 <- drop_data %>% select(species,treatment,activity) %>% group_by(species) %>% summarise(broom::tidy(t.test(activity~treatment, data = cur_data())), .groups = ""keep"")"
"0","fit1 %>% select(statistic,conf.low,conf.high,p.value,parameter)"
"2","Adding missing grouping variables: `species`"
